<div class="reset-password-container">
  <div class="reset-password-card">
    <!-- Loading State (Validating Token) -->
    <div *ngIf="isValidatingToken" class="loading-state">
      <div class="spinner"></div>
      <p class="loading-text">Validating reset link...</p>
    </div>

    <!-- Invalid Token State -->
    <div *ngIf="!isValidatingToken && !isTokenValid && !showSuccess" class="error-state">
      <div class="error-icon">‚ö†Ô∏è</div>
      <h1 class="error-title">Invalid Reset Link</h1>
      <p class="error-message">{{ errorMessage }}</p>
      <p class="error-hint">The password reset link may have expired or already been used.</p>
      <gc-button
        variant="primary"
        size="lg"
        (click)="backToSignIn()"
      >
        Back to Sign In
      </gc-button>
    </div>

    <!-- Success State -->
    <div *ngIf="showSuccess" class="success-state">
      <div class="success-icon">‚úì</div>
      <h1 class="success-title">Password Reset Successfully!</h1>
      <p class="success-message">Your password has been updated. Redirecting to sign in...</p>
    </div>

    <!-- Valid Token - Show Form -->
    <div *ngIf="!isValidatingToken && isTokenValid && !showSuccess">
      <!-- Header -->
      <div class="header">
        <div class="icon">üîí</div>
        <h1 class="title">Reset Password</h1>
        <p class="subtitle" *ngIf="userEmail">
          Creating a new password for <strong>{{ userEmail }}</strong>
        </p>
      </div>

      <!-- Error Message -->
      <div *ngIf="errorMessage" class="alert alert-error">
        <div class="alert-icon">‚úï</div>
        <div class="alert-content">
          <h3 class="alert-title">Error</h3>
          <p class="alert-message">{{ errorMessage }}</p>
        </div>
      </div>

      <!-- Form -->
      <form class="form" (ngSubmit)="onSubmit()">
        <div class="form-group">
          <label for="newPassword" class="form-label">New Password</label>
          <input
            type="password"
            id="newPassword"
            name="newPassword"
            class="form-input"
            [(ngModel)]="newPassword"
            placeholder="Enter new password (min 8 characters)"
            [disabled]="isSubmitting"
            required
            minlength="8"
          />
        </div>

        <div class="form-group">
          <label for="confirmPassword" class="form-label">Confirm Password</label>
          <input
            type="password"
            id="confirmPassword"
            name="confirmPassword"
            class="form-input"
            [(ngModel)]="confirmPassword"
            placeholder="Confirm new password"
            [disabled]="isSubmitting"
            required
          />
        </div>

        <div class="form-actions">
          <gc-button
            type="submit"
            variant="primary"
            size="lg"
            [fullWidth]="true"
            [disabled]="isSubmitting"
          >
            {{ isSubmitting ? 'Resetting Password...' : 'Reset Password' }}
          </gc-button>
        </div>
      </form>

      <!-- Back to Sign In -->
      <div class="footer">
        <button type="button" class="link-button" (click)="backToSignIn()">
          ‚Üê Back to Sign In
        </button>
      </div>
    </div>
  </div>
</div>
