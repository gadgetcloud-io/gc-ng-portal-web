<!-- Dashboard Header -->
<section class="dashboard-header">
  <div class="container">
    <div class="header-content">
      <div class="header-text">
        <h1 class="page-title">Dashboard</h1>
        <p class="page-subtitle">Welcome back, {{ user?.name }}! Here's an overview of your gadgets and warranties.</p>
      </div>
      <gc-button variant="primary" size="md" (click)="onQuickAction('add-device')">
        âž• Add Gadget
      </gc-button>
    </div>
  </div>
</section>

<!-- Stats Grid -->
<section class="stats-section">
  <div class="container">
    <gc-device-stats [stats]="stats"></gc-device-stats>
  </div>
</section>

<!-- Main Content Grid -->
<section class="main-content">
  <div class="container">
    <div class="content-grid">
      <!-- Recent Devices -->
      <gc-card variant="elevated" padding="md" class="devices-card">
        <gc-device-list
          [devices]="devices"
          [isLoading]="isLoading"
          [maxDevices]="4"
          [showActions]="false"
          (addDevice)="openAddDialog()"
          (viewDevice)="onViewDevice($event)"
          (editDevice)="openEditDialog($event)"
          (deleteDevice)="onDeleteDevice($event)"
          (viewDocuments)="openViewDocumentsDialog($event)"
        ></gc-device-list>
      </gc-card>

      <!-- Recent Activity -->
      <gc-card variant="elevated" padding="md" class="activity-card">
        <div class="card-header">
          <h2 class="card-title">Recent Activity</h2>
        </div>

        <!-- Loading State -->
        <div class="loading-state" *ngIf="isLoadingActivity">
          <div class="loading-skeleton" *ngFor="let i of [1,2,3,4,5]">
            <div style="display: flex; gap: var(--space-3); margin-bottom: var(--space-4);">
              <gc-skeleton variant="circle" width="40px" height="40px"></gc-skeleton>
              <div style="flex: 1;">
                <gc-skeleton variant="text" width="80%"></gc-skeleton>
                <gc-skeleton variant="text" width="60%"></gc-skeleton>
                <gc-skeleton variant="text" width="40%"></gc-skeleton>
              </div>
            </div>
          </div>
        </div>

        <!-- Activity List -->
        <div class="activity-list" *ngIf="!isLoadingActivity && recentActivity.length > 0">
          <div *ngFor="let activity of recentActivity" class="activity-item">
            <div class="activity-icon">{{ activity.icon }}</div>
            <div class="activity-content">
              <p class="activity-description">{{ activity.description }}</p>
              <span class="activity-timestamp">{{ activity.relativeTime || activity.timestamp }}</span>
            </div>
          </div>
        </div>

        <!-- Empty State -->
        <gc-empty-state
          *ngIf="!isLoadingActivity && recentActivity.length === 0"
          variant="no-data"
          icon="ðŸ“‹"
          title="No recent activity"
          description="Your activity will appear here once you start using the platform"
          size="sm"
        ></gc-empty-state>
      </gc-card>
    </div>
  </div>
</section>

<!-- Quick Actions & Reminders -->
<section class="secondary-content">
  <div class="container">
    <div class="secondary-grid">
      <!-- Quick Actions -->
      <gc-card variant="elevated" padding="md" class="actions-card">
        <div class="card-header">
          <h2 class="card-title">Quick Actions</h2>
        </div>
        <div class="actions-grid">
          <button
            *ngFor="let action of quickActions"
            class="action-button"
            [class]="'action-' + action.color"
            (click)="onQuickAction(action.action)"
          >
            <span class="action-icon">{{ action.icon }}</span>
            <span class="action-label">{{ action.label }}</span>
          </button>
        </div>
      </gc-card>

      <!-- Upcoming Reminders -->
      <gc-card variant="elevated" padding="md" class="reminders-card">
        <div class="card-header">
          <h2 class="card-title">Upcoming Reminders</h2>
        </div>
        <div class="reminders-list" *ngIf="upcomingReminders.length > 0">
          <div *ngFor="let reminder of upcomingReminders" class="reminder-item">
            <div class="reminder-priority" [class]="getPriorityColor(reminder.priority)"></div>
            <div class="reminder-content">
              <h3 class="reminder-title">{{ reminder.title }}</h3>
              <p class="reminder-date">{{ reminder.date }}</p>
              <gc-badge
                [variant]="reminder.priority === 'high' ? 'error' : reminder.priority === 'medium' ? 'warning' : 'info'"
                size="sm"
              >
                {{ reminder.daysLeft }} days left
              </gc-badge>
            </div>
          </div>
        </div>
        <gc-empty-state
          *ngIf="upcomingReminders.length === 0"
          variant="no-data"
          icon="ðŸ””"
          title="No upcoming reminders"
          description="Warranty expiration reminders will appear here"
          size="sm"
        ></gc-empty-state>
      </gc-card>
    </div>
  </div>
</section>

<!-- Warranty Coverage Chart -->
<section class="chart-section" *ngIf="devices.length > 0">
  <div class="container">
    <gc-card variant="elevated" padding="md" class="chart-card">
      <div class="card-header">
        <h2 class="card-title">Warranty Coverage Overview</h2>
      </div>
      <div class="chart-content">
        <div class="coverage-stats">
          <div class="coverage-item">
            <div class="coverage-bar">
              <div class="coverage-fill coverage-active" [style.width.%]="coverageData.active.percentage"></div>
            </div>
            <div class="coverage-label">
              <span class="coverage-color coverage-active"></span>
              <span>
                Active: {{ coverageData.active.count }} gadget{{ coverageData.active.count !== 1 ? 's' : '' }}
                <gc-badge variant="success" size="sm">{{ coverageData.active.percentage }}%</gc-badge>
              </span>
            </div>
          </div>
          <div class="coverage-item">
            <div class="coverage-bar">
              <div class="coverage-fill coverage-expiring" [style.width.%]="coverageData.expiringSoon.percentage"></div>
            </div>
            <div class="coverage-label">
              <span class="coverage-color coverage-expiring"></span>
              <span>
                Expiring Soon: {{ coverageData.expiringSoon.count }} gadget{{ coverageData.expiringSoon.count !== 1 ? 's' : '' }}
                <gc-badge variant="warning" size="sm">{{ coverageData.expiringSoon.percentage }}%</gc-badge>
              </span>
            </div>
          </div>
          <div class="coverage-item">
            <div class="coverage-bar">
              <div class="coverage-fill coverage-expired" [style.width.%]="coverageData.expired.percentage"></div>
            </div>
            <div class="coverage-label">
              <span class="coverage-color coverage-expired"></span>
              <span>
                Expired: {{ coverageData.expired.count }} gadget{{ coverageData.expired.count !== 1 ? 's' : '' }}
                <gc-badge variant="error" size="sm">{{ coverageData.expired.percentage }}%</gc-badge>
              </span>
            </div>
          </div>
        </div>
      </div>
    </gc-card>
  </div>
</section>

<!-- Dialogs -->
<gc-add-device-dialog
  [isOpen]="isAddDialogOpen"
  (close)="closeAddDialog()"
  (deviceAdded)="onDeviceAdded()"
></gc-add-device-dialog>

<gc-edit-device-dialog
  [isOpen]="isEditDialogOpen"
  [device]="selectedDevice"
  (close)="closeEditDialog()"
  (deviceUpdated)="onDeviceUpdated()"
></gc-edit-device-dialog>

<gc-delete-device-dialog
  [isOpen]="isDeleteDialogOpen"
  [device]="selectedDevice"
  (close)="closeDeleteDialog()"
  (deviceDeleted)="onDeviceDeleted()"
></gc-delete-device-dialog>

<!-- Document Dialogs -->
<gc-upload-document-dialog
  [isOpen]="isUploadDocumentDialogOpen"
  [preselectedDeviceId]="selectedDeviceForDocs?.id"
  (close)="closeUploadDocumentDialog()"
  (documentUploaded)="onDocumentUploaded()"
></gc-upload-document-dialog>

<gc-view-documents-dialog
  [isOpen]="isViewDocumentsDialogOpen"
  [deviceId]="selectedDeviceForDocs?.id"
  [deviceName]="selectedDeviceForDocs?.name"
  (close)="closeViewDocumentsDialog()"
  (deleteDocument)="openDeleteDocumentDialog($event)"
  (uploadNew)="onUploadNewFromViewDialog()"
></gc-view-documents-dialog>

<gc-delete-document-dialog
  [isOpen]="isDeleteDocumentDialogOpen"
  [document]="selectedDocument"
  (close)="closeDeleteDocumentDialog()"
  (documentDeleted)="onDocumentDeleted()"
></gc-delete-document-dialog>
